<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-90095743-1', 'auto');
ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<!-- End Google Analytics -->


    

    



    <meta charset="utf-8">
    
    
    
    <link rel="canonical" href="http://wensibo.top/2017/02/17/一口一口吃掉Volley（二）/">
    
    
    <title>一口一口吃掉Volley（二） | 温斯渤 | To Be A Better Man.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Volley,Android">
    <meta name="description" content="相信看了第一篇教程之后，你应该会对Volley有一个初步的了解了吧，那接下来就继续学习如何使用Volley进行开发吧！">
<meta name="keywords" content="Volley,Android">
<meta property="og:type" content="article">
<meta property="og:title" content="一口一口吃掉Volley（二）">
<meta property="og:url" content="http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/index.html">
<meta property="og:site_name" content="温斯渤">
<meta property="og:description" content="相信看了第一篇教程之后，你应该会对Volley有一个初步的了解了吧，那接下来就继续学习如何使用Volley进行开发吧！">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://www.wensibo.top/file/img/2017-2-17volley/1.jpg">
<meta property="og:image" content="http://www.wensibo.top/file/img/2017-2-17volley/2.png">
<meta property="og:image" content="http://www.wensibo.top/file/img/2017-2-17volley/3.jpg">
<meta property="og:image" content="http://www.wensibo.top/file/img/2017-2-17volley/3.1.gif">
<meta property="og:image" content="http://www.wensibo.top/file/img/2017-2-17volley/5.gif">
<meta property="og:updated_time" content="2018-10-21T08:26:21.408Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一口一口吃掉Volley（二）">
<meta name="twitter:description" content="相信看了第一篇教程之后，你应该会对Volley有一个初步的了解了吧，那接下来就继续学习如何使用Volley进行开发吧！">
<meta name="twitter:image" content="http://www.wensibo.top/file/img/2017-2-17volley/1.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="温斯渤" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">温斯渤</h5>
          <a href="mailto:Wensibob@gmail.com" title="Wensibob@gmail.com" class="mail">Wensibob@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/Wensibob" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.cnblogs.com/ghylzwsb/" target="_blank">
                <i class="icon icon-lg icon-link"></i>
                博客园
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">一口一口吃掉Volley（二）</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">一口一口吃掉Volley（二）</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-02-17T05:37:25.000Z" itemprop="datePublished" class="page-time">
  2017-02-17
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/一口一口吃掉Volley/">一口一口吃掉Volley</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#配置Gradle"><span class="post-toc-number">1.</span> <span class="post-toc-text">配置Gradle</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#添加联网许可"><span class="post-toc-number">2.</span> <span class="post-toc-text">添加联网许可</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用StringRequest"><span class="post-toc-number">3.</span> <span class="post-toc-text">使用StringRequest</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用JsonRequest"><span class="post-toc-number">4.</span> <span class="post-toc-text">使用JsonRequest</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用ImageRequest"><span class="post-toc-number">5.</span> <span class="post-toc-text">使用ImageRequest</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用ImageLoader"><span class="post-toc-number">6.</span> <span class="post-toc-text">使用ImageLoader</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#关于ImageCache"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">关于ImageCache</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-一口一口吃掉Volley（二）" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">一口一口吃掉Volley（二）</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-02-17 13:37:25" datetime="2017-02-17T05:37:25.000Z" itemprop="datePublished">2017-02-17</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/一口一口吃掉Volley/">一口一口吃掉Volley</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>相信看了<a href="http://wensibo.top/2017/02/16/%E4%B8%80%E5%8F%A3%E4%B8%80%E5%8F%A3%E5%90%83%E6%8E%89Volley%EF%BC%88%E4%B8%80%EF%BC%89/" target="_blank" rel="noopener">第一篇教程</a>之后，你应该会对Volley有一个初步的了解了吧，那接下来就继续学习如何使用Volley进行开发吧！<br><a id="more"></a></p>
<h2 id="配置Gradle"><a href="#配置Gradle" class="headerlink" title="配置Gradle"></a>配置Gradle</h2><p>使用如下命令导入Volley库：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.mcxiaoke.volley:library:1.0.19&apos;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如果你还是使用Eclipse进行开发的话，可以下载<a href="http://download.csdn.net/detail/sinyu890807/7152015" target="_blank" rel="noopener">volley的jar包</a>导入工程。</li>
</ul>
<h2 id="添加联网许可"><a href="#添加联网许可" class="headerlink" title="添加联网许可"></a>添加联网许可</h2><p>在AndroidManifest.xml文件中添加联网的请求<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="使用StringRequest"><a href="#使用StringRequest" class="headerlink" title="使用StringRequest"></a>使用StringRequest</h2><p>如果你需要通过网络访问的资源属于String字符串的资源，那么使用StringRequest就最为简单了，只需按照如下步骤就行了。</p>
<p><strong>① 获取一个RequestQueue</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RequestQueue mQueue = Volley.newRequestQueue(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p>
<p><strong>② 构造一个StringRequest对象</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">StringRequest stringRequest=<span class="keyword">new</span> StringRequest(<span class="string">"http://www.wensibo.top"</span></span><br><span class="line">        , <span class="keyword">new</span> Response.Listener&lt;String&gt;() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(String response)</span> </span>&#123;</span><br><span class="line">               <span class="comment">//正常情况下的逻辑处理</span></span><br><span class="line">               String result=<span class="string">""</span>;</span><br><span class="line">               <span class="keyword">try</span> &#123;</span><br><span class="line">                    result= <span class="keyword">new</span> String(response.getBytes(<span class="string">"ISO_8859_1"</span>), <span class="string">"utf-8"</span>);</span><br><span class="line">                   <span class="comment">//由于访问string的时候可能会出现乱码情况，所以保险起见，可以将其转换为utf-8格式</span></span><br><span class="line">                   <span class="comment">//对于其他的自定义Requet都是同理的，均需要在重写parseNetworkResponse方法时设置编码格式，避免乱码的出现</span></span><br><span class="line">               &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">               Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">               intent.setClass(MainActivity.<span class="keyword">this</span>, StringRequestActivity.class);</span><br><span class="line">               intent.putExtra(<span class="string">"string_request"</span>, result);</span><br><span class="line">               startActivity(intent);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;, <span class="keyword">new</span> Response.ErrorListener() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onErrorResponse</span><span class="params">(VolleyError error)</span> </span>&#123;</span><br><span class="line">               <span class="comment">//出错的时候做的一些处理</span></span><br><span class="line">               Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">               intent.setClass(MainActivity.<span class="keyword">this</span>, StringRequestActivity.class);</span><br><span class="line">               intent.putExtra(<span class="string">"string_request"</span>, getResources().getString(R.string.error_message));</span><br><span class="line">               startActivity(intent);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       );</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>由于不同的网页的编码格式不同，为了防止中文乱码情况的出现，代码中将其设置为utf-8即可得到解决。其他的Request如果要避免乱码的出现，也应该采取类似的方法进行处理。</p>
</blockquote>
<p><strong>③ 将StringRequest对象add进RequestQueue</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mQueue.add(stringRequest);</span><br></pre></td></tr></table></figure></p>
<p><strong>看看截图</strong><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://www.wensibo.top/file/img/2017-2-17volley/1.jpg" alt="StringRequest" title="">
                </div>
                <div class="image-caption">StringRequest</div>
            </figure></p>
<h2 id="使用JsonRequest"><a href="#使用JsonRequest" class="headerlink" title="使用JsonRequest"></a>使用JsonRequest</h2><p>有的时候我们不仅需要简单的String资源，还需要获取Json数据，当然Volley也帮我们提供了获取Json的接口，这个就是JsonRequest，使用JsonRequest与StringRequest类似。这里作为例子接收的是北京的天气预报的json对象，获取到的json对象直接打印出来，当然我们还可以获取里面的内容，我将会在自定义的GsonRequest中作介绍。</p>
<p><strong>① 获取一个RequestQueue</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RequestQueue mQueue = Volley.newRequestQueue(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p>
<p><strong>② 构造一个JsonRequest对象</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">JsonObjectRequest jsonObjectRequest=<span class="keyword">new</span> JsonObjectRequest(<span class="string">"http://www.weather.com.cn/data/cityinfo/101010100.html"</span></span><br><span class="line">                , <span class="keyword">new</span> Response.Listener&lt;JSONObject&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(JSONObject response)</span> </span>&#123;</span><br><span class="line">                Log.d(<span class="string">"JsonObject"</span>, response.toString());</span><br><span class="line">                Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">                intent.setClass(MainActivity.<span class="keyword">this</span>, JsonRequestActivity.class);</span><br><span class="line">                intent.putExtra(<span class="string">"json_request"</span>, response.toString());</span><br><span class="line">                startActivity(intent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="keyword">new</span> Response.ErrorListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onErrorResponse</span><span class="params">(VolleyError error)</span> </span>&#123;</span><br><span class="line">                Log.e(<span class="string">"TAG"</span>, error.getMessage(), error);</span><br><span class="line">                Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">                intent.setClass(MainActivity.<span class="keyword">this</span>, JsonRequestActivity.class);</span><br><span class="line">                intent.putExtra(<span class="string">"json_request"</span>, getResources().getString(R.string.error_message));</span><br><span class="line">                startActivity(intent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p>
<p><strong>③ 将JsonRequest对象add进RequestQueue</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mQueue.add(jsonObjectRequest);</span><br></pre></td></tr></table></figure></p>
<p><strong>看看截图</strong><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://www.wensibo.top/file/img/2017-2-17volley/2.png" alt="JsonRequest" title="">
                </div>
                <div class="image-caption">JsonRequest</div>
            </figure></p>
<h2 id="使用ImageRequest"><a href="#使用ImageRequest" class="headerlink" title="使用ImageRequest"></a>使用ImageRequest</h2><p>获取网络上的图片资源是一个很普通的需求，虽然Volley有这个功能，但是放到现在来看都已不是什么稀奇事了，而且功能比较单一，所以这里就简单介绍一下。</p>
<p><strong>① 获取一个RequestQueue</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RequestQueue mQueue = Volley.newRequestQueue(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p>
<p><strong>② 构造一个ImageRequest对象</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ImageRequest imageRequest=<span class="keyword">new</span> ImageRequest(<span class="string">"http://wensibo.top/img/avatar.jpg"</span></span><br><span class="line">                , <span class="keyword">new</span> Response.Listener&lt;Bitmap&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(Bitmap response)</span> </span>&#123;</span><br><span class="line">                Log.d(<span class="string">"SUCCESS"</span>, <span class="string">"成功返回ImageRequest"</span>);</span><br><span class="line">                iv_image_request.setImageBitmap(response);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">0</span>, <span class="number">0</span>, Bitmap.Config.RGB_565, <span class="keyword">new</span> Response.ErrorListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onErrorResponse</span><span class="params">(VolleyError error)</span> </span>&#123;</span><br><span class="line">                Log.d(<span class="string">"ERROR"</span>, <span class="string">"返回ImageRequest失败"</span>);</span><br><span class="line">                iv_image_request.setImageResource(R.drawable.failed_image);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        );</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>可以看到，ImageRequest的构造函数接收六个参数，第一个参数就是图片的URL地址，这个没什么需要解释的。第二个参数是图片请求成功的回调，这里我们把返回的Bitmap参数设置到ImageView中。第三第四个参数分别用于指定允许图片最大的宽度和高度，如果指定的网络图片的宽度或高度大于这里的最大值，则会对图片进行压缩，指定成0的话就表示不管图片有多大，都不会进行压缩。第五个参数用于指定图片的颜色属性，Bitmap.Config下的几个常量都可以在这里使用，其中ARGB_8888可以展示最好的颜色属性，每个图片像素占据4个字节的大小，而RGB_565则表示每个图片像素占据2个字节大小。第六个参数是图片请求失败的回调，这里我们当请求失败时在ImageView中显示一张默认图片。</p>
</blockquote>
<p><strong>③ 将JsonRequest对象add进RequestQueue</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mQueue.add(jsonObjectRequest);</span><br></pre></td></tr></table></figure></p>
<p><strong>看看截图</strong><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://www.wensibo.top/file/img/2017-2-17volley/3.jpg" alt="ImageRequest加载成功" title="">
                </div>
                <div class="image-caption">ImageRequest加载成功</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://www.wensibo.top/file/img/2017-2-17volley/3.1.gif" alt="ImageRequest加载失败" title="">
                </div>
                <div class="image-caption">ImageRequest加载失败</div>
            </figure></p>
<h2 id="使用ImageLoader"><a href="#使用ImageLoader" class="headerlink" title="使用ImageLoader"></a>使用ImageLoader</h2><p>Volley在请求网络图片方面除了ImageRequest之外，还有另外一个更加高效的ImageLoader。ImageLoader用于加载网络上的图片，并且它的内部也是使用ImageRequest来实现的，不过ImageLoader明显要比ImageRequest更加高效，因为它不仅可以帮我们对图片进行缓存，还可以过滤掉重复的链接，避免重复发送请求。<br>由于ImageLoader已经不是继承自Request的了，所以它的用法也和我们之前学到的内容有所不同，总结起来大致可以分为以下四步：</p>
<p><strong>① 获取一个RequestQueue</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RequestQueue mQueue = Volley.newRequestQueue(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p>
<p><strong>② 构造一个ImageLoader对象</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ImageLoader imageLoader = <span class="keyword">new</span> ImageLoader(mQueue, <span class="keyword">new</span> ImageCache() &#123;  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">putBitmap</span><span class="params">(String url, Bitmap bitmap)</span> </span>&#123;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bitmap <span class="title">getBitmap</span><span class="params">(String url)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;  </span><br><span class="line">    &#125;  );</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>ImageLoader的构造函数接收两个参数，第一个参数就是RequestQueue对象，第二个参数是一个ImageCache对象，这里我们先new出一个空的ImageCache的实现即可。具体的ImageCache待会讲解。</p>
</blockquote>
<p><strong>③构造一个ImageListener对象</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ImageListener listener = imageLoader.getImageListener(iv_image_loader, R.drawable.failed_image, R.drawable.failed_image);</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>getImageListener()方法接收三个参数，第一个参数指定用于显示图片的ImageView控件，第二个参数指定加载图片的过程中显示的图片，第三个参数指定加载图片失败的情况下显示的图片。</p>
</blockquote>
<p><strong>④调用ImageLoader的get()方法加载网络上的图片</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imageLoader.get(<span class="string">"http://wensibo.top/img/avatar.jpg"</span>, listener);</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>最后，调用ImageLoader的get()方法来加载图片，get()方法接收两个参数，第一个参数就是图片的URL地址，第二个参数则是刚刚获取到的ImageListener对象。当然，如果你想对图片的大小进行限制，也可以使用get()方法的重载，指定图片允许的最大宽度和高度，如下所示：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imageLoader.get(<span class="string">"http://wensibo.top/img/avatar.jpg"</span>, listener,<span class="number">200</span>,<span class="number">200</span>);</span><br></pre></td></tr></table></figure>
<h3 id="关于ImageCache"><a href="#关于ImageCache" class="headerlink" title="关于ImageCache"></a>关于ImageCache</h3><p>刚才讲到ImageLoader的构造函数的第二个参数是一个ImageCache对象，刚才介绍的ImageLoader的优点也在于此。他能起到图片缓存的作用。接下来我们就自己写一个呗！<br>这里我们新建一个BitmapCache并实现了ImageCache接口：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BitmapCache</span> <span class="keyword">implements</span> <span class="title">ImageCache</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LruCache&lt;String, Bitmap&gt; mCache;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BitmapCache</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//将缓存图片的大小设置为8M</span></span><br><span class="line">        <span class="keyword">int</span> maxSize = <span class="number">8</span> * <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line">        mCache = <span class="keyword">new</span> LruCache&lt;String, Bitmap&gt;(maxSize)&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">sizeOf</span><span class="params">(String key, Bitmap bitmap)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> bitmap.getRowBytes() * bitmap.getHeight();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bitmap <span class="title">getBitmap</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mCache.get(url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">putBitmap</span><span class="params">(String url, Bitmap bitmap)</span> </span>&#123;</span><br><span class="line">        mCache.put(url, bitmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>这里我们将缓存图片的大小设置为8M。接着修改创建ImageLoader实例的代码，第二个参数传入BitmapCache的实例：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ImageLoader imageLoader = <span class="keyword">new</span> ImageLoader(mQueue, <span class="keyword">new</span> BitmapCache());</span><br></pre></td></tr></table></figure>
<p><strong>看看效果吧！</strong><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://www.wensibo.top/file/img/2017-2-17volley/5.gif" alt="ImageLoader" title="">
                </div>
                <div class="image-caption">ImageLoader</div>
            </figure></p>
<p><a href="http://wensibo.top/2017/02/17/%E4%B8%80%E5%8F%A3%E4%B8%80%E5%8F%A3%E5%90%83%E6%8E%89Volley%EF%BC%88%E4%B8%89%EF%BC%89/" target="_blank" rel="noopener">下节课</a>我们将一起自定义Request来满足我们的使用！come on ！</p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2018-10-21T08:26:21.408Z" itemprop="dateUpdated">2018-10-21 16:26:21</time>
</span><br>


        
        如需转发请与我联系，获得允许之后请注明出处：<a href="/2017/02/17/一口一口吃掉Volley（二）/" target="_blank" rel="external">http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/</a>
        
    </div>
    
    <footer>
        <a href="http://www.wensibo.top">
            <img src="/img/avatar.jpg" alt="温斯渤">
            温斯渤
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Volley/">Volley</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/&title=《一口一口吃掉Volley（二）》 — 温斯渤&pic=http://www.wensibo.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/&title=《一口一口吃掉Volley（二）》 — 温斯渤&source=相信看了第一篇教程之后，你应该会对Volley有一个初步的了解了吧，那接下来就继续学习如何使用Volley进行开发吧！" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《一口一口吃掉Volley（二）》 — 温斯渤&url=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/&via=http://www.wensibo.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2017/02/17/一口一口吃掉Volley（三）/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">一口一口吃掉Volley（三）</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/02/16/一口一口吃掉Volley（一）/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">一口一口吃掉Volley（一）</h4>
      </a>
    </div>
  
</nav>



    

<div id="SOHUCS" sid="一口一口吃掉Volley（二）"></div>
<script charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/changyan.js"></script>
<script type="text/javascript">
window.changyan.api.config({
appid: 'cysVTLUcO',
conf: 'prod_b1c3ae71ea1c8bc27704176ee6d17112'
});
</script>

















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大佬
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>温斯渤 &copy; 2015 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/&title=《一口一口吃掉Volley（二）》 — 温斯渤&pic=http://www.wensibo.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/&title=《一口一口吃掉Volley（二）》 — 温斯渤&source=相信看了第一篇教程之后，你应该会对Volley有一个初步的了解了吧，那接下来就继续学习如何使用Volley进行开发吧！" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《一口一口吃掉Volley（二）》 — 温斯渤&url=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/&via=http://www.wensibo.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.wensibo.top/2017/02/17/一口一口吃掉Volley（二）/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACxUlEQVR42u3aQW4CMQwFUO5/6VbqCqmdzLedAJXerNCAkrwsYmPn8Yifr5+n+u3z+9+/+Xp6qqNtfvDw8PBaS796rpay/mXyeT1jslnRCHh4eHjHePlw6zc5bH2GV8PM5Xs8PDy8t/J2bcF6a5I14OHh4f1HXh4kqgWFjwgMeHh4eAEvKUb0aqSTzdpQzsDDw8M7wKs2wD7h88H+Hh4eHt6gq95rcSUlifUaek2vP8bBw8PDO8DrlVarmPXS8+3Lo8CjOg0eHh5ekVddei93TX6/Lsgmb6JNwcPDwxvwJqlzXpBNdrdXtL35Fg8PD++FvN5B30t2c2oySxQY8PDw8Ma8ZCnV5DhJvqsBIC/+FnYODw8Pr8XL2069CwfRUsZh5qb1hYeHh7eJ12vh9xpR1cbYkVtjeHh4eAdguwq4ScqejJYXcAvRDw8PD+8Ar3rG5u97IWEUKvDw8PC28uZt/snS96bvNw0wPDw8vE28/PxMyrJ5ilxoYsWYy9Hw8PDwXsLrHf1JESEvKPQuLkSBAQ8PD2/Ay8uy+SFebXH1ku9os/Dw8PAO8HoHep6Cz/EbUmo8PDy8rbzJEZ8UI6rb0WunXW4NHh4e3gFedcrJhaqkwZYXhfPwg4eHh7eX1zu4TxQOyv8AkvXg4eHhHeDNA0M1pc7LDb2LCzdXB/Dw8PDGvPwIzhPZPEWuzp4n5Xh4eHiv5/Wa9JNLWvk2FbYSDw8P7wCvmkZXW/u9C1i9EFX4PR4eHt6AN79oNbleMLmsEIUEPDw8vAO83rGbXBrI21pJqMjX0Cuj4OHh4VV5k5JEfqzvKjeUC754eHh4x3jVYJAvelLYzee9HBkPDw/vrbze0Zwge/8AolXh4eHhfQyvPE2xeVYtGW8ODHh4eHgBr9f4r25Hb4N6s+Ph4eGd401ubOWXqHrttDy539bfw8PDw1vxvgE0j+Qp3pJsFQAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


lazyScripts.push('//s95.cnzz.com/z_stat.php?id=1261131866&web_id=1261131866')

</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
